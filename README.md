# Order Cleaning System (Bewell Test)

## ЁЯУЛ р╕ар╕▓р╕Юр╕гр╕зр╕б
р╕гр╕░р╕Ър╕Ъ Order Cleaning р╣Ар╕Ыр╣Зр╕Щр╕гр╕░р╕Ър╕Ър╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╣Бр╕ер╕░р╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕ер╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Лр╕╖р╣Йр╕нр╕Вр╕нр╕Зр╕Яр╕┤р╕ер╣Мр╕бр╕Бр╕▒р╕Щр╕гр╕нр╕в р╣Вр╕Фр╕вр╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Бр╕Ыр╕ер╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕▓р╕Б `InputOrder` р╣Гр╕лр╣Йр╣Ар╕Ыр╣Зр╕Щ `CleanedOrder` р╕Чр╕╡р╣Ир╕бр╕╡р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕░р╕нр╕▓р╕Фр╣Бр╕ер╕░р╕кр╕бр╕Ър╕╣р╕гр╕Ур╣М

## ЁЯПЧя╕П р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Ыр╕гр╣Ар╕Ир╕Д

```
bewell_test/
тФЬтФАтФА models/
тФВ   тФФтФАтФА order.go          # Data structures р╕кр╕│р╕лр╕гр╕▒р╕Ъ InputOrder р╣Бр╕ер╕░ CleanedOrder
тФЬтФАтФА constants/
тФВ   тФФтФАтФА constant.go       # р╕Др╣Ир╕▓р╕Др╕Зр╕Чр╕╡р╣Ир╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Фр╕Вр╕нр╕Зр╕гр╕░р╕Ър╕Ъ
тФЬтФАтФА services/
тФВ   тФФтФАтФА cleaner.go        # Logic р╕лр╕ер╕▒р╕Бр╣Гр╕Щр╕Бр╕▓р╕гр╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕ер╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Лр╕╖р╣Йр╕н
тФФтФАтФА test/
    тФФтФАтФА cleaner_test.go   # Test cases р╕Др╕гр╕нр╕Ър╕Др╕ер╕╕р╕бр╕Чр╕╕р╕Бр╕Бр╕гр╕Ур╕╡
```

## ЁЯУК Data Models

### InputOrder
```go
type InputOrder struct {
    No                int     // р╕лр╕бр╕▓р╕вр╣Ар╕ер╕Вр╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Лр╕╖р╣Йр╕н
    PlatformProductId string  // р╕гр╕лр╕▒р╕кр╕кр╕┤р╕Щр╕Др╣Йр╕▓р╕Ир╕▓р╕Б platform (р╕нр╕▓р╕Ир╕бр╕╡р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕кр╕╡р╕в)
    Qty               int     // р╕Ир╕│р╕Щр╕зр╕Щр╕Чр╕╡р╣Ир╕кр╕▒р╣Ир╕З
    UnitPrice         float64 // р╕гр╕▓р╕Др╕▓р╕Хр╣Ир╕нр╕лр╕Щр╣Ир╕зр╕в (р╣Др╕бр╣Ир╣Гр╕Кр╣Йр╣Гр╕Щр╕Бр╕▓р╕гр╕Др╕│р╕Щр╕зр╕У)
    TotalPrice        float64 // р╕гр╕▓р╕Др╕▓р╕гр╕зр╕б
}
```

### CleanedOrder
```go
type CleanedOrder struct {
    No         int     // р╕лр╕бр╕▓р╕вр╣Ар╕ер╕Вр╕ер╕│р╕Фр╕▒р╕Ъ
    ProductId  string  // р╕гр╕лр╕▒р╕кр╕кр╕┤р╕Щр╕Др╣Йр╕▓р╕Чр╕╡р╣Ир╕кр╕░р╕нр╕▓р╕Ф
    MaterialId string  // р╕гр╕лр╕▒р╕кр╕зр╕▒р╕кр╕Фр╕╕ (р╣Ар╕Кр╣Ир╕Щ FG0A-CLEAR, FG0A-MATTE)
    ModelId    string  // р╕гр╕лр╕▒р╕кр╕гр╕╕р╣Ир╕Щ (р╣Ар╕Кр╣Ир╕Щ IPHONE16PROMAX, OPPOA3)
    Qty        int     // р╕Ир╕│р╕Щр╕зр╕Щр╕Ир╕гр╕┤р╕З (р╕гр╕зр╕б multiplier)
    UnitPrice  float64 // р╕гр╕▓р╕Др╕▓р╕Хр╣Ир╕нр╕лр╕Щр╣Ир╕зр╕вр╕Чр╕╡р╣Ир╕Др╕│р╕Щр╕зр╕Ур╣Гр╕лр╕бр╣И
    TotalPrice float64 // р╕гр╕▓р╕Др╕▓р╕гр╕зр╕б
}
```

## тЪЩя╕П р╕Бр╕▓р╕гр╕Чр╕│р╕Зр╕▓р╕Щр╕лр╕ер╕▒р╕Б

### 1. Product ID Cleaning
р╕гр╕░р╕Ър╕Ър╕Ир╕░р╕Чр╕│р╕Др╕зр╕▓р╕бр╕кр╕░р╕нр╕▓р╕Ф `PlatformProductId` р╣Вр╕Фр╕в:
- р╕ер╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Вр╕вр╕░ (р╣Ар╕Кр╣Ир╕Щ `x2-3&`, `%20x`)
- р╕Фр╕╢р╕Зр╣Ар╕Йр╕Юр╕▓р╕░ Product ID р╕Ир╕гр╕┤р╕З (р╕гр╕╣р╕Ыр╣Бр╕Ър╕Ъ: `FG[0-9A-Z]+-[A-Z]+-[A-Z0-9-]+`)
- р╕Ир╕▒р╕Фр╕Бр╕▓р╕г Quantity Multiplier (р╣Ар╕Кр╣Ир╕Щ `*3` р╕лр╕бр╕▓р╕вр╕Цр╕╢р╕Зр╕Др╕╣р╕У 3)

### 2. Bundle Order Processing
р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Лр╕╖р╣Йр╕нр╣Бр╕Ър╕Ъ Bundle (р╕бр╕╡ `/` р╕Др╕▒р╣Ир╕Щ):
- р╣Бр╕вр╕Бр╣Бр╕Хр╣Ир╕ер╕░р╕кр╕┤р╕Щр╕Др╣Йр╕▓р╕нр╕нр╕Бр╕Ир╕▓р╕Бр╕Бр╕▒р╕Щ
- р╕Др╕│р╕Щр╕зр╕Ур╕гр╕▓р╕Др╕▓р╕Хр╣Ир╕нр╕лр╕Щр╣Ир╕зр╕вр╣Вр╕Фр╕вр╣Бр╕Ър╣Ир╕Зр╕Ир╕│р╕Щр╕зр╕Щр╕гр╕зр╕б
- р╕кр╕гр╣Йр╕▓р╕З CleanedOrder р╣Бр╕вр╕Бр╕Хр╣Ир╕▓р╕Зр╕лр╕▓р╕Б

### 3. Free Items Generation
р╕гр╕░р╕Ър╕Ър╕Ир╕░р╕кр╕гр╣Йр╕▓р╕Зр╕Вр╕нр╕Зр╣Бр╕Цр╕бр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤:
- **WIPING-CLOTH**: р╕Ьр╣Йр╕▓р╣Ар╕Кр╣Зр╕Ф (р╕Ир╕│р╕Щр╕зр╕Щр╣Ар╕Чр╣Ир╕▓р╕Бр╕▒р╕Ър╕кр╕┤р╕Щр╕Др╣Йр╕▓р╕лр╕ер╕▒р╕Б)
- **[TEXTURE]-CLEANNER**: р╕Щр╣Йр╕│р╕вр╕▓р╕Чр╕│р╕Др╕зр╕▓р╕бр╕кр╕░р╕нр╕▓р╕Ф (р╕Хр╕▓р╕бр╕Ыр╕гр╕░р╣Ар╕ар╕Чр╕зр╕▒р╕кр╕Фр╕╕)

## ЁЯзк Test Cases

### Test Case 1: Basic Order
```
Input: "FG0A-CLEAR-IPHONE16PROMAX", Qty: 2
Output: 3 orders (р╕лр╕ер╕▒р╕Б + р╕Ьр╣Йр╕▓р╣Ар╕Кр╣Зр╕Ф + р╕Щр╣Йр╕│р╕вр╕▓)
```

### Test Case 2: Dirty Product ID
```
Input: "x2-3&FG0A-CLEAR-IPHONE16PROMAX", Qty: 2
Output: р╕Чр╕│р╕Др╕зр╕▓р╕бр╕кр╕░р╕нр╕▓р╕Ф ID р╣Бр╕ер╣Йр╕зр╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕ер╕Хр╕▓р╕бр╕Ыр╕Бр╕Хр╕┤
```

### Test Case 3: Quantity Multiplier
```
Input: "FG0A-MATTE-IPHONE16PROMAX*3", Qty: 1
Output: р╕Ир╕│р╕Щр╕зр╕Щр╕Ир╕гр╕┤р╕З = 3, р╕гр╕▓р╕Др╕▓р╕Хр╣Ир╕нр╕лр╕Щр╣Ир╕зр╕в = 30
```

### Test Case 5: Bundle Order
```
Input: "FG0A-CLEAR-OPPOA3/FG0A-CLEAR-OPPOA3-B/FG0A-MATTE-OPPOA3"
Output: 6 orders (3 р╕лр╕ер╕▒р╕Б + р╕Ьр╣Йр╕▓р╣Ар╕Кр╣Зр╕Ф + 2 р╕Щр╣Йр╕│р╕вр╕▓)
```

## ЁЯФз р╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

### р╕Бр╕▓р╕гр╕гр╕▒р╕Щр╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕б
```bash
go run cmd/main.go
```

### р╕Бр╕▓р╕гр╕гр╕▒р╕Щр╣Ар╕Чр╕к
```bash
go test ./...
```

### р╕Бр╕▓р╕гр╕гр╕▒р╕Щр╣Ар╕Чр╕кр╣Ар╕Йр╕Юр╕▓р╕░
```bash
go test ./test -v
```

## тЪб Constants

р╕гр╕░р╕Ър╕Ър╣Гр╕Кр╣Йр╕Др╣Ир╕▓р╕Др╕Зр╕Чр╕╡р╣Ир╕Ир╕▓р╕Б `constants/constant.go`:

```go
// Product related constants
const (
    WipingClothProductId = "WIPING-CLOTH"
    CleanerSuffix       = "-CLEANNER"
    BundleSeparator     = "/"
    ProductIdSeparator  = "-"
)

// Regex patterns
const (
    ProductIdPattern    = `(FG[0-9A-Z]+-[A-Z]+-[A-Z0-9\-]+)(\*\d+)?`
    QtyMultiplierPattern = `\*(\d+)`
)

// Default values
const (
    DefaultQtyMultiplier = 1
    DefaultUnitPrice     = 0.0
    DefaultTotalPrice    = 0.0
    MinProductParts      = 3
)
```

## ЁЯЪА Features

- тЬЕ **Product ID Cleaning**: р╕ер╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Вр╕вр╕░р╣Бр╕ер╕░р╕Фр╕╢р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕│р╕Др╕▒р╕Н
- тЬЕ **Bundle Processing**: р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Лр╕╖р╣Йр╕нр╣Бр╕Ър╕Ър╕гр╕зр╕б
- тЬЕ **Quantity Multiplier**: р╕гр╕нр╕Зр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╕Др╕╣р╕Ур╕Ир╕│р╕Щр╕зр╕Щ
- тЬЕ **Free Items**: р╕кр╕гр╣Йр╕▓р╕Зр╕Вр╕нр╕Зр╣Бр╕Цр╕бр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤
- тЬЕ **Price Calculation**: р╕Др╕│р╕Щр╕зр╕Ур╕гр╕▓р╕Др╕▓р╕Хр╣Ир╕нр╕лр╕Щр╣Ир╕зр╕вр╣Гр╕лр╕бр╣И
- тЬЕ **Constants Management**: р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Др╣Ир╕▓р╕Др╕Зр╕Чр╕╡р╣Ир╕нр╕вр╣Ир╕▓р╕Зр╣Ар╕Ыр╣Зр╕Щр╕гр╕░р╕Ър╕Ъ
- тЬЕ **Comprehensive Testing**: Test cases р╕Др╕гр╕нр╕Ър╕Др╕ер╕╕р╕бр╕Чр╕╕р╕Бр╕Бр╕гр╕Ур╕╡

## ЁЯУЭ р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕

- р╕гр╕░р╕Ър╕Ър╕Ир╕░р╕Др╕│р╕Щр╕зр╕У `UnitPrice` р╣Гр╕лр╕бр╣Ир╕Ир╕▓р╕Б `TotalPrice / RealQty`
- `UnitPrice` р╕Ир╕▓р╕Б InputOrder р╕Ир╕░р╣Др╕бр╣Ир╕Цр╕╣р╕Бр╣Гр╕Кр╣Йр╣Гр╕Щр╕Бр╕▓р╕гр╕Др╕│р╕Щр╕зр╕У
- р╕кр╕│р╕лр╕гр╕▒р╕Ъ Bundle Order р╕гр╕▓р╕Др╕▓р╕Ир╕░р╕Цр╕╣р╕Бр╣Бр╕Ър╣Ир╕Зр╕Хр╕▓р╕бр╕кр╕▒р╕Фр╕кр╣Ир╕зр╕Щр╕Ир╕│р╕Щр╕зр╕Щр╕кр╕┤р╕Щр╕Др╣Йр╕▓
- р╕Вр╕нр╕Зр╣Бр╕Цр╕бр╕Ир╕░р╕бр╕╡ `UnitPrice` р╣Бр╕ер╕░ `TotalPrice` р╣Ар╕Ыр╣Зр╕Щ 0 